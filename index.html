<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Mail Aktion: Gaza-Freedom-Flotilla</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 40px auto;
            background: rgba(255, 255, 255, 0.97);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            border: 1px solid #e0e0e0;
        }
        
        header {
            background: linear-gradient(to right, #1a2a6c, #2c3e50);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .content {
            padding: 30px;
        }
        
        .email-template {
            background-color: #f8f9fa;
            border-left: 5px solid #1a2a6c;
            padding: 25px;
            margin: 30px 0;
            border-radius: 0 8px 8px 0;
            font-size: 1.05rem;
            line-height: 1.8;
            white-space: pre-wrap;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .input-section {
            background: #e9ecef;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
            text-align: center;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
        }
        
        .input-group {
            margin: 20px auto;
            max-width: 500px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 1.1rem;
            color: #1a2a6c;
            text-align: left;
        }
        
        input {
            width: 100%;
            padding: 14px;
            border: 2px solid #ced4da;
            border-radius: 8px;
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        
        input:focus {
            border-color: #1a2a6c;
            outline: none;
            box-shadow: 0 0 0 3px rgba(26, 42, 108, 0.2);
        }
        
        button {
            background: linear-gradient(to right, #1a2a6c, #b21f1f);
            color: white;
            border: none;
            padding: 16px 40px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            background: linear-gradient(to right, #b21f1f, #1a2a6c);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        .note {
            font-size: 0.95rem;
            color: #6c757d;
            margin-top: 15px;
            font-style: italic;
        }
        
        .result-section {
            display: none;
            background: #d4edda;
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
            border-left: 5px solid #28a745;
        }
        
        .representative-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
            justify-content: center;
        }
        
        .representative-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            flex: 1;
            min-width: 250px;
            max-width: 300px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            border: 1px solid #e0e0e0;
        }
        
        .representative-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }
        
        .representative-card h3 {
            color: #1a2a6c;
            margin-bottom: 10px;
            font-size: 1.3rem;
        }
        
        .party-tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .party-cdu { background: #000; color: white; }
        .party-spd { background: #E3000F; color: white; }
        .party-gruene { background: #64A12D; color: white; }
        .party-fdp { background: #FFED00; color: #333; }
        .party-linke { background: #BE3075; color: white; }
        .party-afd { background: #009EE0; color: white; }
        .party-default { background: #6c757d; color: white; }
        
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
            padding: 20px;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #1a2a6c;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error {
            display: none;
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 5px solid #dc3545;
        }
        
        footer {
            text-align: center;
            padding: 25px;
            background: #1a2a6c;
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.9rem;
        }
        
        .info-box {
            background: #e7f3ff;
            border-left: 5px solid #1a2a6c;
            padding: 20px;
            border-radius: 0 8px 8px 0;
            margin: 25px 0;
        }
        
        .info-box h3 {
            color: #1a2a6c;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .steps {
            display: flex;
            justify-content: space-between;
            margin: 40px 0;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .step {
            flex: 1;
            min-width: 250px;
            padding: 20px;
            text-align: center;
            background: #f8f9fa;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            border: 1px solid #e0e0e0;
            transition: transform 0.3s;
        }
        
        .step:hover {
            transform: translateY(-5px);
        }
        
        .step i {
            font-size: 2.5rem;
            color: #1a2a6c;
            margin-bottom: 15px;
            background: rgba(26, 42, 108, 0.1);
            width: 70px;
            height: 70px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .step h3 {
            margin-bottom: 10px;
            color: #1a2a6c;
        }
        
        .step p {
            color: #555;
        }
        
        @media (max-width: 768px) {
            .steps {
                flex-direction: column;
            }
            
            .container {
                margin: 20px;
            }
            
            header {
                padding: 20px;
            }
            
            .content {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
        
        .action-title {
            text-align: center;
            margin: 20px 0;
            color: #1a2a6c;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .action-title i {
            font-size: 1.8rem;
        }
        
        .highlight {
            background: linear-gradient(120deg, rgba(26,42,108,0.1), transparent);
            padding: 3px 8px;
            border-radius: 5px;
        }
        
        .proxy-info {
            background: #e7f3ff;
            border-left: 5px solid #1a2a6c;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            margin: 15px 0;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-envelope"></i> E-Mail Aktion: Gaza-Freedom-Flotilla</h1>
            <p class="subtitle">Senden Sie eine E-Mail an Ihre Abgeordneten, um die Sicherheit der Aktivist:innen auf der "Madleen" zu fordern</p>
        </header>
        
        <div class="content">
            <div class="proxy-info">
                <i class="fas fa-info-circle"></i> Diese Seite verwendet einen Proxy-Service, um die Abgeordnetendaten abzurufen.
            </div>
            
            <div class="info-box">
                <h3><i class="fas fa-info-circle"></i> Worum geht es?</h3>
                <p>Die deutsche Staatsbürgerin <span class="highlight">Yasemin Acar</span> befindet sich an Bord der Gaza-Freedom-Flotilla <span class="highlight">"Madleen"</span>. Israel hat militärische Angriffe auf das zivile Schiff in internationalen Gewässern angedroht. Vor dem Hintergrund früherer Angriffe auf ähnliche Flotillas ist diese Drohung besonders ernst zu nehmen.</p>
            </div>
            
            <h2 class="action-title"><i class="fas fa-file-alt"></i> E-Mail-Vorlage an Abgeordnete:</h2>
            <div class="email-template">
Sehr geehrte Abgeordnete des Auswärtigen Amts/des Auswärtigen Ausschusses,

derzeit befindet sich die deutsche Staatsbürgerin Yasemin Acar an Bord der Gaza-Freedom-Flotilla „Madleen".
Gemeinsam mit anderen Aktivist:innen versucht sie, Israels völkerrechtswidrige Blockade des Gazastreifens zu durchbrechen, um Lebensmittel und medizinische Vorräte nach Gaza zu bringen. Israels Verteidigungsminister kündigt offen den Einsatz der israelischen Armee gegen dieses Vorhaben an und droht einem zivilen Schiff in internationalen Gewässern mit militärischen Angriffen.

Diese Drohungen sind besonders ernst zu nehmen vor dem Hintergrund des israelischen Angriffs auf die Gaza-Flotilla im Mai 2010, bei dem Israel neun Aktivist:innen tötete und Dutzende verwundete, sowie aufgrund der Drohnenangriffe auf die Gaza-Flotilla „Conscience" vor etwa einem Monat.

Ich fordere Sie daher auf, alle zur Verfügung stehenden Mittel zu nutzen, um die Sicherheit der Aktivist:innen auf der „Madleen" zu gewährleisten.

Mit freundlichen Grüßen,
[Ihr Name]
            </div>
            
            <div class="steps">
                <div class="step">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3>Schritt 1</h3>
                    <p>Geben Sie Ihre Postleitzahl ein, um Ihre lokalen Abgeordneten zu finden</p>
                </div>
                <div class="step">
                    <i class="fas fa-search"></i>
                    <h3>Schritt 2</h3>
                    <p>Wir identifizieren die zuständigen Abgeordneten für Ihre Region</p>
                </div>
                <div class="step">
                    <i class="fas fa-paper-plane"></i>
                    <h3>Schritt 3</h3>
                    <p>E-Mail wird vorbereitet und kann direkt versendet werden</p>
                </div>
            </div>
            
            <div class="input-section">
                <h2 class="action-title"><i class="fas fa-envelope-open-text"></i> E-Mail jetzt versenden</h2>
                <p>Geben Sie Ihre Postleitzahl ein, um die Aktion zu starten:</p>
                
                <div class="input-group">
                    <label for="plz"><i class="fas fa-mail-bulk"></i> Ihre Postleitzahl:</label>
                    <input type="text" id="plz" placeholder="5-stellige PLZ (z.B. 10117)" maxlength="5">
                    <p class="note">Wir verwenden Ihre PLZ, um die für Sie zuständigen Abgeordneten zu finden</p>
                </div>
                
                <button onclick="findRepresentative()">
                    <i class="fas fa-paper-plane"></i> Jetzt E-Mail an Abgeordnete schicken
                </button>
                
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Suche Abgeordnete für Ihre Region...</p>
                </div>
                
                <div class="error" id="error">
                    <i class="fas fa-exclamation-triangle"></i> <span id="error-message"></span>
                </div>
            </div>
            
            <div class="result-section" id="result-section">
                <h2><i class="fas fa-check-circle"></i> Abgeordnete gefunden!</h2>
                <p>Wir haben folgende Abgeordnete für Ihre Region identifiziert:</p>
                
                <div class="representative-container" id="representative-container">
                    <!-- Hier werden die Abgeordneten-Karten eingefügt -->
                </div>
                
                <button onclick="sendEmail()">
                    <i class="fas fa-envelope"></i> E-Mail jetzt öffnen und senden
                </button>
            </div>
        </div>
        
        <footer>
            <p>Diese Kampagne dient dem Schutz von Menschenrechten und zivilgesellschaftlichem Engagement</p>
            <p>© 2023 Initiative für Frieden und Menschenrechte</p>
        </footer>
    </div>

    <script>
        // Globale Variable für die gefundenen Abgeordneten
        let representatives = [];
        
        // Funktion zum Suchen der Abgeordneten per PLZ mit Proxy
        async function findRepresentative() {
            const plz = document.getElementById('plz').value;
            
            // PLZ-Validierung
            if (!/^\d{5}$/.test(plz)) {
                showError("Bitte geben Sie eine gültige 5-stellige Postleitzahl ein");
                return;
            }
            
            // Ladeanimation anzeigen
            document.getElementById('loading').style.display = 'block';
            document.getElementById('error').style.display = 'none';
            document.getElementById('result-section').style.display = 'none';
            
            try {
                // Proxy-Service zur Umgehung von CORS-Beschränkungen
                const proxyUrl = 'https://api.allorigins.win/raw?url=';
                const apiUrl = `https://www.abgeordnetenwatch.de/api/v2/constituencies?zipcode=${plz}&parliament=5`;
                
                const response = await fetch(proxyUrl + encodeURIComponent(apiUrl));
                const data = await response.json();
                
                if (!data.data || data.data.length === 0) {
                    showError("Für Ihre PLZ wurde kein Wahlkreis gefunden. Bitte versuchen Sie eine benachbarte PLZ.");
                    return;
                }
                
                // Wahlkreis-ID extrahieren
                const constituencyId = data.data[0].id;
                
                // Abgeordnete für den Wahlkreis abrufen
                const membersApiUrl = `https://www.abgeordnetenwatch.de/api/v2/candidacies-mandates?constituency=${constituencyId}&mandate_type=1&parliament=5&is_active=true`;
                const membersResponse = await fetch(proxyUrl + encodeURIComponent(membersApiUrl));
                const membersData = await membersResponse.json();
                
                if (!membersData.data || membersData.data.length === 0) {
                    showError("Für Ihren Wahlkreis wurden keine aktiven Abgeordneten gefunden.");
                    return;
                }
                
                // Abgeordnete aufbereiten
                representatives = membersData.data.map(member => {
                    // Parteifarbe ermitteln
                    let partyClass = 'party-default';
                    if (member.politician.party === 'CDU') partyClass = 'party-cdu';
                    if (member.politician.party === 'SPD') partyClass = 'party-spd';
                    if (member.politician.party === 'Bündnis 90/Die Grünen') partyClass = 'party-gruene';
                    if (member.politician.party === 'FDP') partyClass = 'party-fdp';
                    if (member.politician.party === 'Die Linke') partyClass = 'party-linke';
                    if (member.politician.party === 'AfD') partyClass = 'party-afd';
                    
                    return {
                        id: member.id,
                        name: member.politician.label,
                        email: member.politician.contact.email,
                        party: member.politician.party,
                        partyClass: partyClass,
                        constituency: data.data[0].name,
                        img: member.politician.photo || `https://via.placeholder.com/100?text=${member.politician.label.substring(0,2)}`
                    };
                });
                
                // Ergebnisse anzeigen
                showRepresentatives();
                
            } catch (error) {
                showError("Es gab ein Problem bei der Suche nach Abgeordneten. Bitte versuchen Sie es später erneut.");
                console.error("API Fehler:", error);
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }
        
        // Funktion zum Anzeigen der Abgeordneten
        function showRepresentatives() {
            const container = document.getElementById('representative-container');
            container.innerHTML = '';
            
            if (representatives.length === 0) {
                container.innerHTML = '<p>Keine Abgeordneten gefunden</p>';
                return;
            }
            
            representatives.forEach(rep => {
                const card = document.createElement('div');
                card.className = 'representative-card';
                card.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <img src="${rep.img}" alt="${rep.name}" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 2px solid #e0e0e0;">
                        <div>
                            <h3>${rep.name}</h3>
                            <span class="party-tag ${rep.partyClass}">${rep.party}</span>
                        </div>
                    </div>
                    <p><strong>Wahlkreis:</strong> ${rep.constituency}</p>
                    <p><strong>E-Mail:</strong> ${rep.email || 'Keine E-Mail verfügbar'}</p>
                `;
                container.appendChild(card);
            });
            
            document.getElementById('result-section').style.display = 'block';
        }
        
        // Funktion zum Anzeigen von Fehlermeldungen
        function showError(message) {
            document.getElementById('error-message').textContent = message;
            document.getElementById('error').style.display = 'block';
        }
        
        // Funktion zum Erstellen und Senden der E-Mail
        function sendEmail() {
            if (representatives.length === 0) {
                showError("Bitte suchen Sie zuerst nach Abgeordneten");
                return;
            }
            
            // Nur Abgeordnete mit E-Mail-Adresse
            const validReps = representatives.filter(rep => rep.email);
            
            if (validReps.length === 0) {
                showError("Keine der gefundenen Abgeordneten hat eine öffentliche E-Mail-Adresse");
                return;
            }
            
            // E-Mail-Inhalt
            const subject = "Dringender Appell: Sicherheit der Aktivist:innen auf der Madleen gewährleisten";
            const body = `Sehr geehrte Abgeordnete des Auswärtigen Amts/des Auswärtigen Ausschusses,

derzeit befindet sich die deutsche Staatsbürgerin Yasemin Acar an Bord der Gaza-Freedom-Flotilla „Madleen".
Gemeinsam mit anderen Aktivist:innen versucht sie, Israels völkerrechtswidrige Blockade des Gazastreifens zu durchbrechen, um Lebensmittel und medizinische Vorräte nach Gaza zu bringen. Israels Verteidigungsminister kündigt offen den Einsatz der israelischen Armee gegen dieses Vorhaben an und droht einem zivilen Schiff in internationalen Gewässern mit militärischen Angriffen.

Diese Drohungen sind besonders ernst zu nehmen vor dem Hintergrund des israelischen Angriffs auf die Gaza-Flotilla im Mai 2010, bei dem Israel neun Aktivist:innen tötete und Dutzende verwundete, sowie aufgrund der Drohnenangriffe auf die Gaza-Flotilla „Conscience" vor etwa einem Monat.

Ich fordere Sie daher auf, alle zur Verfügung stehenden Mittel zu nutzen, um die Sicherheit der Aktivist:innen auf der „Madleen" zu gewährleisten.

Mit freundlichen Grüßen,
[Ihr Name]`;

            // Mailto-Link erstellen (alle Empfänger in BCC)
            const bccEmails = validReps.map(rep => rep.email).join(',');
            const mailtoLink = `mailto:?bcc=${encodeURIComponent(bccEmails)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            // Mail-Client öffnen
            window.location.href = mailtoLink;
        }
        
        // Demo-Daten für Startseite anzeigen
        function showDemoData() {
            const container = document.getElementById('representative-container');
            container.innerHTML = `
                <div class="representative-card">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <img src="https://via.placeholder.com/80?text=AS" alt="Anna Schmidt" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 2px solid #e0e0e0;">
                        <div>
                            <h3>Anna Schmidt</h3>
                            <span class="party-tag party-spd">SPD</span>
                        </div>
                    </div>
                    <p><strong>Wahlkreis:</strong> Berlin-Mitte</p>
                    <p><strong>E-Mail:</strong> anna.schmidt@bundestag.de</p>
                </div>
                <div class="representative-card">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <img src="https://via.placeholder.com/80?text=MB" alt="Max Bauer" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 2px solid #e0e0e0;">
                        <div>
                            <h3>Max Bauer</h3>
                            <span class="party-tag party-cdu">CDU</span>
                        </div>
                    </div>
                    <p><strong>Wahlkreis:</strong> Berlin-Mitte</p>
                    <p><strong>E-Mail:</strong> max.bauer@bundestag.de</p>
                </div>
            `;
        }
        
        // Demo-Daten beim Laden anzeigen
        window.onload = showDemoData;
    </script>
</body>
</html>
